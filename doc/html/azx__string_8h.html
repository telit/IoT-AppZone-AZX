<!-- HTML header for doxygen 1.8.15-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.16"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>AZ Extension Libraries: stage/azx/core/hdr/azx_string.h File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link rel="shortcut icon" href="favicon.ico" type="image/x-icon"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
  $(document).ready(initResizable);
/* @license-end */</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="telit_style.css" rel="stylesheet" type="text/css"/>
<link href="telit_navtree.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 100px;">
  <td id="projectlogo"><img alt="Logo" src="telit-logo.png"/></td>
  <td id="projectalign" style="padding-left: 2em;">
   <div id="projectname">AZ Extension Libraries
   &#160;<span id="projectnumber">1.5.55.f372318</span>
   </div>
   <div id="projectbrief">A set of companion libraries that make AZ development easier</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.16 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('azx__string_8h.html','');});
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">azx_string.h File Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>String manipulation library.  
<a href="#details">More...</a></p>
<div class="textblock"><code>#include &quot;m2mb_types.h&quot;</code><br />
<code>#include &quot;<a class="el" href="azx__log_8h_source.html">azx_log.h</a>&quot;</code><br />
</div><div class="textblock"><div class="dynheader">
Include dependency graph for azx_string.h:</div>
<div class="dyncontent">
<div class="center"><img src="azx__string_8h__incl.png" border="0" usemap="#stage_2azx_2core_2hdr_2azx__string_8h" alt=""/></div>
<map name="stage_2azx_2core_2hdr_2azx__string_8h" id="stage_2azx_2core_2hdr_2azx__string_8h">
<area shape="rect" title="String manipulation library." alt="" coords="5,5,136,47"/>
<area shape="rect" title=" " alt="" coords="17,169,125,196"/>
<area shape="rect" href="azx__log_8h.html" title="Logging utilities to print on available output channels." alt="" coords="70,95,149,121"/>
</map>
</div>
</div><div class="textblock"><div class="dynheader">
This graph shows which files directly or indirectly include this file:</div>
<div class="dyncontent">
<div class="center"><img src="azx__string_8h__dep__incl.png" border="0" usemap="#stage_2azx_2core_2hdr_2azx__string_8hdep" alt=""/></div>
<map name="stage_2azx_2core_2hdr_2azx__string_8hdep" id="stage_2azx_2core_2hdr_2azx__string_8hdep">
<area shape="rect" title="String manipulation library." alt="" coords="83,5,213,47"/>
<area shape="rect" href="azx__adc_8h.html" title="Read from and write to a peripheral via ADC." alt="" coords="5,95,136,136"/>
<area shape="rect" href="azx__apn_8h.html" title="Automatically setting APN based on the ICCID of the SIM." alt="" coords="160,95,291,136"/>
<area shape="rect" href="azx__connectivity_8h.html" title="Establish network and data connection synchronously and provide info." alt="" coords="158,184,293,225"/>
</map>
</div>
</div>
<p><a href="azx__string_8h_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a226b4be186b9144fed210546b565da8e"><td class="memItemLeft" align="right" valign="top">BOOLEAN&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="azx__string_8h.html#a226b4be186b9144fed210546b565da8e">azx_containsString</a> (const CHAR *const *list, const CHAR *string)</td></tr>
<tr class="memdesc:a226b4be186b9144fed210546b565da8e"><td class="mdescLeft">&#160;</td><td class="mdescRight">Returns TRUE if string is in list.  <a href="azx__string_8h.html#a226b4be186b9144fed210546b565da8e">More...</a><br /></td></tr>
<tr class="separator:a226b4be186b9144fed210546b565da8e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af8880aac18c3a5b84156917f20af09b3"><td class="memItemLeft" align="right" valign="top">INT32&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="azx__string_8h.html#af8880aac18c3a5b84156917f20af09b3">azx_getFirstNumber</a> (const CHAR *from_here, INT32 *ok)</td></tr>
<tr class="memdesc:af8880aac18c3a5b84156917f20af09b3"><td class="mdescLeft">&#160;</td><td class="mdescRight">Goes over the provided string and returns the first number.  <a href="azx__string_8h.html#af8880aac18c3a5b84156917f20af09b3">More...</a><br /></td></tr>
<tr class="separator:af8880aac18c3a5b84156917f20af09b3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a396c55ce1880c732b7244a0ba1a7f95a"><td class="memItemLeft" align="right" valign="top">INT32&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="azx__string_8h.html#a396c55ce1880c732b7244a0ba1a7f95a">azx_parseStringf</a> (const CHAR *str, const CHAR *format,...)</td></tr>
<tr class="memdesc:a396c55ce1880c732b7244a0ba1a7f95a"><td class="mdescLeft">&#160;</td><td class="mdescRight">Parses and extracts values from a string.  <a href="azx__string_8h.html#a396c55ce1880c732b7244a0ba1a7f95a">More...</a><br /></td></tr>
<tr class="separator:a396c55ce1880c732b7244a0ba1a7f95a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a945a6abe1dbbc236148a6a8bbf5e7126"><td class="memItemLeft" align="right" valign="top">INT32&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="azx__string_8h.html#a945a6abe1dbbc236148a6a8bbf5e7126">azx_parseHexByteMsg</a> (const CHAR *response, const CHAR *tag, INT32 max_size, UINT8 *buffer)</td></tr>
<tr class="memdesc:a945a6abe1dbbc236148a6a8bbf5e7126"><td class="mdescLeft">&#160;</td><td class="mdescRight">Parse hex strings into data buffer.  <a href="azx__string_8h.html#a945a6abe1dbbc236148a6a8bbf5e7126">More...</a><br /></td></tr>
<tr class="separator:a945a6abe1dbbc236148a6a8bbf5e7126"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>String manipulation library. </p>
<dl class="section version"><dt>Version</dt><dd>1.0.3 </dd></dl>
<dl class="section user"><dt>Dependencies</dt><dd>core/azx_log </dd></dl>
<dl class="section author"><dt>Author</dt><dd>Sorin Basca </dd></dl>
<dl class="section date"><dt>Date</dt><dd>01/06/2017</dd></dl>
<p>This library is a providing a fast and stack safe way to extract various data types ((sub)strings, integers, floats) from long-winded strings whose format is previously known. </p>
</div><h2 class="groupheader">Function Documentation</h2>
<a id="a226b4be186b9144fed210546b565da8e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a226b4be186b9144fed210546b565da8e">&#9670;&nbsp;</a></span>azx_containsString()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">BOOLEAN azx_containsString </td>
          <td>(</td>
          <td class="paramtype">const CHAR *const *&#160;</td>
          <td class="paramname"><em>list</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const CHAR *&#160;</td>
          <td class="paramname"><em>string</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Returns TRUE if string is in list. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">list</td><td>The list of strings to search in. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">string</td><td>The string to find.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd><code>TRUE</code> if the string is inside the list. </dd></dl>

</div>
</div>
<a id="af8880aac18c3a5b84156917f20af09b3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af8880aac18c3a5b84156917f20af09b3">&#9670;&nbsp;</a></span>azx_getFirstNumber()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">INT32 azx_getFirstNumber </td>
          <td>(</td>
          <td class="paramtype">const CHAR *&#160;</td>
          <td class="paramname"><em>from_here</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">INT32 *&#160;</td>
          <td class="paramname"><em>ok</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Goes over the provided string and returns the first number. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">from_here</td><td>the string to consider. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">ok</td><td>whether the result is valid.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>The first number found in the provided string. </dd></dl>

</div>
</div>
<a id="a945a6abe1dbbc236148a6a8bbf5e7126"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a945a6abe1dbbc236148a6a8bbf5e7126">&#9670;&nbsp;</a></span>azx_parseHexByteMsg()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">INT32 azx_parseHexByteMsg </td>
          <td>(</td>
          <td class="paramtype">const CHAR *&#160;</td>
          <td class="paramname"><em>response</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const CHAR *&#160;</td>
          <td class="paramname"><em>tag</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">INT32&#160;</td>
          <td class="paramname"><em>max_size</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">UINT8 *&#160;</td>
          <td class="paramname"><em>buffer</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Parse hex strings into data buffer. </p>
<p>Parses a message of the format "#SOME_NAME: &lt;size&gt;\r\n&lt;bytes:00A325...&gt;". It converts the hex bytes into <code>UINT8</code> values and stored them in the provided buffer.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">response</td><td>The AT response </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">tag</td><td>The tag in the response (for example "#SRECV:") </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">max_size</td><td>The maximum number of bytes to store in the buffer </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">buffer</td><td>The buffer where to store the bytes</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>The number of bytes stored in the buffer. If <code>max_size</code> is less than bytes available, some bytes will be lost and the return will be the number of bytes that should have been stored. If there are no bytes to parse, this returns 0. In case of error -1 is returned. </dd></dl>

</div>
</div>
<a id="a396c55ce1880c732b7244a0ba1a7f95a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a396c55ce1880c732b7244a0ba1a7f95a">&#9670;&nbsp;</a></span>azx_parseStringf()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">INT32 azx_parseStringf </td>
          <td>(</td>
          <td class="paramtype">const CHAR *&#160;</td>
          <td class="paramname"><em>str</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const CHAR *&#160;</td>
          <td class="paramname"><em>format</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>...</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Parses and extracts values from a string. </p>
<p>Extracts values from a string based on a format. The format allows one of the following:</p><ul>
<li>regular character - match the character</li>
<li><code>%%</code> - match <code>%</code></li>
<li><code>%*[^&lt;list-of-chars&gt;]</code> - skip until the list of chars is found</li>
<li><code>%*[&lt;list-of-chars&gt;]</code> - skip while characters from the list are found</li>
<li><code>%&lt;number&gt;[^&lt;list-of-chars&gt;]</code> - store into a string characters until either <code>&lt;number&gt;</code> are stored (<code>NUL</code> will be appended, so allow space for it), or one of the chars in <code>&lt;list of chars&gt;</code> is found. If there is not enough space (<code>&lt;number&gt;+1</code>) to store the full match, then the parsing will stop straight away.</li>
<li><code>%&lt;number&gt;[&lt;list-of-chars&gt;]</code> - as above, only keep inserting while the characters are the same as in the list</li>
<li><code>%</code><code>x</code> - extract 32 bit integer</li>
<li><code>%</code><code>d</code> - extract 32 bit integer</li>
<li><code>%</code><code>u</code> - extract unsigned 32 bit integer</li>
<li><code>%</code><code>f</code> - extract float</li>
<li><code>%</code><code>ld</code> - extract 64 bit integer</li>
<li><code>%</code><code>lu</code> - extract unsigned 64 bit integer</li>
<li><code>%</code><code>_</code> - extract location within string (useful for parsing substrings)</li>
</ul>
<p>Where &lt;list-of-chars&gt; is expected, the list should <b>not</b> have more than 128 expanded characters. Some characters need to be escaped with '\'. The list of them is the following: <code>"\^]"</code>. Also ranges are expanded, for example <code>[a-z]</code> is expanded to <code>[abcdefghijklmnopqrstuv]</code>.</p>
<p>This parser is implemented to support a subset of what is supported by <code>sscanf</code>. Ideally <code>sscanf</code> should be used, but it could cause issues for big strings as it uses the internal HEAP. This implementation uses the application HEAP giving more control of memory usage on a modem</p>
<p>If items are added into the parser, they should be done in a way that keeps the format strings accepted as <code>sscanf</code>-compliant.</p>
<p>Example: </p><pre class="fragment">UINT8 mode = 0xFF;
CHAR operator[32] = { 0 };
UINT8 act = 0xFF;

const CHAR* at_rsp = AZX_ATI_SEND_COMMAND(AZX_AT_DEFAULT_TIMEOUT, "AT+COPS?");
// at_rsp now contains: '+COPS: 0,0,"Cyta-Voda",0'
const CHAR* cops_fmt = "%*[^+]+COPS: %d,%*[^,],\"%32[^\"]\",%d";

if (!at_rsp || 1 &gt; azx_parseStringf(at_rsp, rsp_fmt, &amp;mode, operator, &amp;act))
{
    AZX_LOG_WARN("Unexpected +COPS response\r\n");
}
else
{
    AZX_LOG_INFO("Operator: %s, act: %d, mode: %d\r\n", operator, act, mode);
}
</pre><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">str</td><td>The string from which to extract </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">format</td><td>The rules to follow when extracting </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">...</td><td>Variadic parameters where the information from <code>str</code> that is needed it extracted to. The number of arguments depend on the format string specified. If the wrong number is passed, or the types of the parameters are not aligned to the format string, the outcome is unpredictable.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Number of extracted items </dd></dl>

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- HTML footer for doxygen 1.8.15-->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="dir_a451d24824756e59bc0ab465137a1721.html">stage</a></li><li class="navelem"><a class="el" href="dir_159a56f2f375d6f48b3d40b3fd23d10a.html">azx</a></li><li class="navelem"><a class="el" href="dir_3e7d3f5cdeaa0d2916b9c57d66c8d865.html">core</a></li><li class="navelem"><a class="el" href="dir_df95525600129d8bfad6c42108ff5419.html">hdr</a></li><li class="navelem"><a class="el" href="azx__string_8h.html">azx_string.h</a></li>
    <li class="footer">Generated by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.16 </li>
    <li class="footer">
      © Telit 2019 All rights reserved.
      <a href="https://telit.com/copyright-policy/">Copyright Policy</a> |
      <a href="https://www.telit.com/editorial-policy-and-process/">Editorial Policy</a> |
      <a href="https://telit.com/eu-privacy-policy/">EU Privacy Policy</a> |
      <a href="https://telit.com/privacy-policy/">Global Privacy Policy</a> |
      <a href="https://www.telit.com/modern-slavery-statement/">Modern Slavery Statement</a> |
      <a href="https://telit.com/terms-of-use/">Terms of Use</a> </li>
  </ul>
</div>
</body>
</html>
